# Data Model: Phase I - In-Memory Python Console Todo App

**Date**: 2026-01-17
**Feature**: 001-phase1-todo-cli

## Entities

### Task Entity

**Location**: `src/models/task.py`

```python
from dataclasses import dataclass, field
from datetime import datetime
from enum import Enum


class TaskStatus(Enum):
    """Task completion status."""
    PENDING = "pending"
    COMPLETE = "complete"


@dataclass
class Task:
    """
    Represents a single todo item stored in memory.

    Attributes:
        id: Unique sequential identifier (auto-generated, resets on restart)
        title: Task title (required, max 200 characters)
        description: Task description (optional)
        status: Completion status (pending/complete)
        created_at: Timestamp when task was created
    """
    id: int
    title: str
    description: str = ""
    status: TaskStatus = TaskStatus.PENDING
    created_at: datetime = field(default_factory=datetime.now)

    def __post_init__(self) -> None:
        """Validate task data after initialization."""
        if not self.title:
            raise ValueError("Title is required")
        if len(self.title) > 200:
            self.title = self.title[:200]

    @property
    def is_complete(self) -> bool:
        """Check if task is marked as complete."""
        return self.status == TaskStatus.COMPLETE

    @property
    def status_indicator(self) -> str:
        """Return visual status indicator."""
        return "✓" if self.is_complete else "☐"

    def mark_complete(self) -> None:
        """Mark task as complete."""
        self.status = TaskStatus.COMPLETE

    def mark_incomplete(self) -> None:
        """Mark task as incomplete/pending."""
        self.status = TaskStatus.PENDING

    def __str__(self) -> str:
        """String representation for display."""
        desc = f" - {self.description}" if self.description else ""
        return f"[{self.id}] {self.status_indicator} {self.title}{desc}"
```

## Field Specifications

| Field | Type | Required | Default | Constraints |
|-------|------|----------|---------|-------------|
| `id` | `int` | Yes | Auto-generated | Sequential, positive, unique |
| `title` | `str` | Yes | - | Non-empty, max 200 chars |
| `description` | `str` | No | `""` | Any text |
| `status` | `TaskStatus` | No | `PENDING` | Enum: PENDING/COMPLETE |
| `created_at` | `datetime` | No | Now | Auto-set on creation |

## Validation Rules

1. **Title Validation**:
   - MUST NOT be empty
   - MUST NOT exceed 200 characters (truncated if longer)
   - Raises `ValueError` if empty

2. **ID Validation**:
   - MUST be positive integer
   - MUST be unique within session
   - Auto-generated by TaskService

3. **Status Validation**:
   - MUST be valid TaskStatus enum value
   - Default: PENDING

## State Transitions

```
┌─────────────────────────────────────────┐
│                                         │
│  ┌─────────┐         ┌──────────┐       │
│  │ PENDING │ ──────► │ COMPLETE │       │
│  └─────────┘         └──────────┘       │
│       ▲                   │             │
│       │                   │             │
│       └───────────────────┘             │
│                                         │
└─────────────────────────────────────────┘

Actions:
- mark_complete(): PENDING → COMPLETE
- mark_incomplete(): COMPLETE → PENDING
```

## Storage Model

**In-Memory Storage** (TaskService):

```python
class TaskService:
    """Manages task storage and CRUD operations."""

    _tasks: dict[int, Task]  # ID -> Task mapping
    _next_id: int            # Next available ID
```

| Storage | Type | Description |
|---------|------|-------------|
| `_tasks` | `dict[int, Task]` | O(1) lookup by ID |
| `_next_id` | `int` | Sequential ID counter |

## Relationships

Phase I has a single entity (Task) with no relationships.

Future phases may add:
- User → Task (ownership)
- Task → Tags (many-to-many)
- Task → Category (many-to-one)

## Type Hints

All code MUST use Python 3.13+ type hints:

```python
# Function signatures
def add_task(self, title: str, description: str = "") -> Task: ...
def get_task(self, task_id: int) -> Task | None: ...
def get_all_tasks(self) -> list[Task]: ...
def update_task(self, task_id: int, title: str | None = None, description: str | None = None) -> Task | None: ...
def delete_task(self, task_id: int) -> bool: ...
def mark_complete(self, task_id: int) -> Task | None: ...
def mark_incomplete(self, task_id: int) -> Task | None: ...
```
